# Tornado 在线聊天室

这是一个基于 Tornado 框架开发的实时在线聊天室应用，支持多人同时在线聊天、私聊、表情发送、文件上传等功能。

## 功能特点

### 1. 用户管理
- 支持设置和修改用户昵称
- 显示在线用户列表
- 实时更新用户状态（加入/离开）
- 用户昵称持久化存储（Cookie）

### 2. 消息功能
- 群聊消息发送和接收
- 私聊功能（点击用户列表中的用户进入私聊模式）
- 支持发送文本消息
- 支持发送表情（内置20个常用表情）
- 系统消息提醒（用户加入、离开、改名等）
- 消息历史记录保存（最近100条）

### 3. 文件处理
- 支持文件上传功能
- 自动生成唯一文件名
- 支持图片预览
- 支持文件下载
- 文件安全存储

### 4. 界面特性
- 响应式设计
- 实时更新的用户列表
- 消息区域自动滚动
- 简洁的表情选择器
- 私聊状态可视化提示

### 5. 安全特性
- XSRF 保护
- 用户输入转义
- 文件上传安全控制
- WebSocket 安全连接

### 6. 日志功能
- 详细的操作日志记录
- 用户行为追踪
- 错误信息记录
- 支持文件和控制台输出

## 技术栈
- 后端：Python + Tornado
- 前端：原生 JavaScript + WebSocket
- 存储：文件系统 + 内存存储

## 安装和运行

1. 安装依赖：
```bash
pip install tornado
```

2. 运行服务器：
```bash
python tornado_api/chat_app/chat_server.py
```

3. 访问应用：
打开浏览器访问 `http://localhost:8888`

## 目录结构
```
tornado_api/chat_app/
├── chat_server.py      # 服务器主程序
├── static/            # 静态文件目录
│   ├── script.js     # 前端JavaScript
│   ├── style.css     # 样式文件
│   └── uploads/      # 上传文件存储目录
└── templates/        # 模板文件目录
    ├── chat.html    # 聊天室页面
    └── login.html   # 登录页面
```

## 使用说明

1. 首次访问时，需要设置昵称
2. 进入聊天室后可以：
   - 发送文本消息
   - 点击表情按钮发送表情
   - 点击上传按钮发送文件
   - 点击用户列表中的用户进行私聊
   - 点击昵称可以修改昵称

## 日志查看
- 日志文件位置：`chat.log`
- 日志内容包括：
  - 用户加入/离开记录
  - 消息发送记录
  - 昵称修改记录
  - 错误信息记录

## 注意事项
1. 上传文件大小有限制
2. 消息历史记录限制为最近100条
3. 需要现代浏览器支持（支持WebSocket）
4. 建议使用Chrome或Firefox浏览器访问

## 开发者
- 作者：[您的名字]
- 版本：1.0.0
- 许可证：MIT

## 未来计划
- [ ] 添加用户认证系统
- [ ] 支持消息持久化存储
- [ ] 添加更多表情包
- [ ] 支持图片压缩
- [ ] 添加管理员功能
